<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Choisis ton zine</title>
<style>
  body { font-family: Helvetica; padding: 20px; text-align: center; }
  .grid { display: grid; grid-template-columns: repeat(20, 60px); grid-gap: 5px; justify-content: center; margin-top: 20px; }
  .cell {
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    border-radius: 50%;
    cursor: pointer;
    transition: 0.2s;
    font-size: 12px;
  }
  .avail { background: #000; color: #fff; }
  .sold { background: transparent; color: rgba(0,0,0,0.6); cursor: not-allowed; }
  .cell:hover { transform: scale(1.1); }
</style>
</head>
<body>
<h2>Choisis ton zine</h2>
<div class="grid" id="grid"></div>

<script>
// Paramètres
const totalZines = 200;
const workerURL = "https://monworker.alexandre-67f.workers.dev";

// Fonction pour choisir le pid Payrexx (exemple alternance)
function getPid(i) {
  return (i % 2 === 0) ? "9708a08e" : "d0fbc9e0";
}

// Crée la grille
fetch(`${workerURL}/sold.json`)
  .then(r => r.json())
  .then(soldList => {
    const grid = document.getElementById("grid");
    for (let i = 1; i <= totalZines; i++) {
      const id = `ZINE_${i}`;
      const sold = soldList.includes(id);

      const cell = document.createElement("div");
      cell.className = "cell " + (sold ? "sold" : "avail");
      cell.textContent = `${i}/200`;

      if (!sold) {
        const pid = getPid(i);
        const link = `https://alexandreadnane.payrexx.com/fr/pay?pid=${9708a08e}&referenceId=${id}`;
        cell.onclick = () => window.open(link, "_blank");
      }

      grid.appendChild(cell);
    }
  });
</script>
</body>
</html>

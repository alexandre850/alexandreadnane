<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Choisis ton zine</title>
<style>
body { font-family: Helvetica, sans-serif; padding: 20px; text-align: center; }
.grid { display: grid; grid-template-columns: repeat(20, 60px); grid-gap: 5px; justify-content: center; margin-top: 20px; }
.cell {
  width: 60px;
  height: 60px;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  font-weight: bold;
  cursor: pointer;
  transition: 0.2s;
  font-size: 12px;
}
.avail { background: #000; color: #fff; }
.sold { background: transparent; color: rgba(0,0,0,0.6); cursor: not-allowed; border: none; }
.cell:hover { transform: scale(1.1); }
</style>
</head>
<body>
<h2>Choisis ton zine :</h2>
<div class="grid" id="grid"></div>

<script>
// URL de ton Worker Cloudflare
const WORKER_URL = "https://nom-de-ton-worker.workers.dev";

// Total zines
const TOTAL_ZINES = 200;

// Tableau des PID Payrexx (exemple : alterner deux liens, tu peux adapter)
const PIDS = [
  "9708a08e", // premier lien
  "d0fbc9e0"  // deuxiÃ¨me lien
];
const DEFAULT_PID = PIDS[0];

fetch(`${WORKER_URL}/sold.json`)
  .then(r => r.json())
  .then(soldList => {
    const grid = document.getElementById("grid");

    for (let i = 1; i <= TOTAL_ZINES; i++) {
      const id = `ZINE_${i}`;
      const sold = soldList.includes(id);

      const cell = document.createElement("div");
      cell.className = "cell " + (sold ? "sold" : "avail");
      cell.textContent = `${i}/200`;

      if (!sold) {
        const pid = PIDS[(i-1) % PIDS.length] || DEFAULT_PID;
        cell.onclick = () =>
          window.open(`https://alexandreadnane.payrexx.com/fr/pay?pid=${pid}&referenceId=${id}`);
      }

      grid.appendChild(cell);
    }
  });
</script>
</body>
</html>
